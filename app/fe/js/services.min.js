"use strict";var wmoServices=angular.module("wmoServices",["ngResource"]);wmoServices.factory("Account",["$window",function(e){return{loggedOut:function(){return 0===(e.sessionStorage.getItem("sessID")||"").length},loggedIn:function(){return(e.sessionStorage.getItem("sessID")||"").length>0}}}]),wmoServices.factory("Calendar",[function(){var e=this;return e.dayMilliSeconds=864e5,e.factory={utc:function(e){var t,r=e||new Date,n=(new Date).getTimezoneOffset();return r instanceof Date||(r=new Date(r)),t=new Date(r.getFullYear(),r.getMonth(),r.getDate()),new Date(t.setMinutes(t.getMinutes()-n))},today:function(){return e.factory.utc()},local:function(e){var t=e,r=(new Date).getTimezoneOffset();return("number"==typeof e||e instanceof Number)&&(t=new Date(e)),new Date(t.setMinutes(t.getMinutes()+r))},addDays:function(t,r){var n=t||e.factory.today(),r=Number(r);return n instanceof Date||(n=new Date(n)),new Date(n.getFullYear(),n.getMonth(),n.getDate()+r)},addMonths:function(t,r){var n=t||e.factory.today(),r=Number(r);return n instanceof Date||(n=new Date(n)),new Date(n.getFullYear(),n.getMonth()+r,n.getDate())},addYears:function(t,r){var n=t||e.factory.today(),r=Number(r);return n instanceof Date||(n=new Date(n)),new Date(n.getFullYear()+r,n.getMonth(),n.getDate())},yyyyMMdd:function(t,r){var n=t||e.factory.today();n instanceof Date||(n=e.factory.local(n));var r=r||"",o=n.getFullYear(),a=Number(n.getMonth())+1,s=Number(n.getDate());return a<10&&(a="0"+a),s<10&&(s="0"+s),[o,a,s].join(r)},dayPeriod:function(t,r){var t=t||e.factory.today(),r=r||e.factory.today();return t instanceof Date||(t=new Date(t)),r instanceof Date||(r=new Date(r)),Math.round(Math.abs(r.getTime()-t.getTime())/e.dayMilliSeconds)},dayMilliSeconds:function(){return e.dayMilliSeconds}},e.factory}]),wmoServices.factory("CreateUser",["$resource",function(e){return e($REST,{},{get:{method:"POST",params:{api:"createUser"},headers:{Auth:"createuser"}}})}]),wmoServices.factory("Enroll",["$resource",function(e){return e($REST,{},{checkEmail:{method:"POST",params:{api:"enroll",operand:"checkEmail"},headers:{Auth:"enroll"}},checkPhone:{method:"POST",params:{api:"enroll",operand:"checkPhone"},headers:{Auth:"enroll"}},reassert:{method:"POST",params:{api:"enroll",operand:"reassert"},headers:{Auth:"enroll"}}})}]),wmoServices.factory("FilterSortTranslated",["$rootScope",function(e){return function(t,r){if(r=(r||"").length>0&&r){var n="^"+r,o=new RegExp(n,"i");t=t.filter(function(t){return o.test(e.lang.tr(t))})}return t.sort(function(t,r){var n=e.lang.tr(t).toLowerCase().replace(/\s+/g,""),o=e.lang.tr(r).toLowerCase().replace(/\s+/g,"");return n>o?1:n<o?-1:0})}}]),wmoServices.factory("GetPlans",["$resource","$window",function(e,t){var r=this;return r.set=function(t){return e($REST,{},{getAll:{method:"POST",params:{api:"getPlans",operand:"all"},headers:{Auth:t}},getActive:{method:"POST",params:{api:"getPlans",operand:"active"},headers:{Auth:t}},getPermanent:{method:"POST",params:{api:"getPlans",operand:"permanent"},headers:{Auth:t}},getPending:{method:"POST",params:{api:"getPlans",operand:"pending"},headers:{Auth:t}},getCompleted:{method:"POST",params:{api:"getPlans",operand:"completed"},headers:{Auth:t}}})},{getAll:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).getAll(e,n)},getActive:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).getActive(e,n)},getPermanent:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).getPermanent(e,n)},getCompleted:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).getCompleted(e,n)},getPending:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).getPending(e,n)}}}]),wmoServices.factory("GetUser",["$resource","$window",function(e,t){var r=this;return r.set=function(t){return e($REST,{},{get:{method:"POST",params:{api:"operateUser",operand:"get"},headers:{Auth:t}},update:{method:"POST",params:{api:"operateUser",operand:"update"},headers:{Auth:t}}})},{get:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).get(e,n)},update:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).update(e,n)}}}]),wmoServices.factory("LangMngr",["$window","$rootScope",function(e,t){var r=this;return r.lang=e.sessionStorage.getItem("lang")||"eng",r.direction=e.sessionStorage.getItem("direction")||"ltr",r.locale=e.sessionStorage.getItem("locale")||"en",r.factory={getDirection:function(e){return $RTLS.indexOf(e)>-1?"rtl":"ltr"},getOppositeDirection:function(e){return $RTLS.indexOf(e)>-1?"ltr":"rtl"},getFloatDirection:function(e){return"rtl"===e?"right":"left"},getOppositeFloatDirection:function(e){return"rtl"===e?"left":"right"},showLTR:function(){return"ltr"===r.direction},showRTL:function(){return"rtl"===r.direction},tr:function(e,t){var t=t||r.lang;return e.isArray?e.map(function(e){return $DICT[e][t]}):$DICT[e][t]},getLocale:function(e){return $LANGS.filter(function(t){return t.value===e})[0].locale},setLang:function(n){r.lang=n,r.direction=r.factory.getDirection(n),r.locale=r.factory.getLocale(n),t.lang.lang=n,t.lang.direction=r.direction,t.lang.locale=r.locale,t.lang.floatDir=r.factory.getFloatDirection(r.direction),t.lang.oppositeFloatDir=r.factory.getOppositeFloatDirection(r.direction),e.sessionStorage.setItem("lang",n),e.sessionStorage.setItem("direction",r.direction),e.sessionStorage.setItem("locale",r.locale)},init:function(){return{lang:r.lang,direction:r.direction,locale:r.locale,floatDir:r.factory.getFloatDirection(r.direction),oppositeFloatDir:r.factory.getOppositeFloatDirection(r.direction),tr:r.factory.tr}}},r.factory}]),wmoServices.factory("Login",["$resource",function(e){return e($REST,{},{get:{method:"POST",params:{api:"login"},headers:{Auth:"login"}}})}]),wmoServices.factory("Logout",["$resource","$window",function(e,t){var r=this;return r.set=function(t){return e($REST,{},{get:{method:"POST",params:{api:"logout"},headers:{Auth:t}}})},{get:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).get(e,n)}}}]),wmoServices.factory("OperatePlan",["$resource","$window",function(e,t){var r=this;return r.set=function(t){return e($REST,{},{get:{method:"POST",params:{api:"operatePlan",operand:"get"},headers:{Auth:t}},update:{method:"POST",params:{api:"operatePlan",operand:"update"},headers:{Auth:t}},create:{method:"POST",params:{api:"operatePlan",operand:"create"},headers:{Auth:t}},remove:{method:"POST",params:{api:"operatePlan",operand:"remove"},headers:{Auth:t}}})},{get:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).get(e,n)},update:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).update(e,n)},create:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).create(e,n)},remove:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).remove(e,n)}}}]),wmoServices.factory("Registration",["$window",function(e){return{mailDenied:function(){return 0===(e.sessionStorage.getItem("email")||"").length},mailConfirmed:function(){return(e.sessionStorage.getItem("email")||"").length>0}}}]),wmoServices.factory("Validate",["$resource","$window",function(e,t){var r=this;return r.set=function(t){return e($REST,{},{get:{method:"POST",params:{api:"validate"},headers:{Auth:t}}})},{get:function(e,n){var o=t.sessionStorage.getItem("sessID");r.set(o).get(e,n)}}}]),wmoServices.factory("ValidateByPassword",["$uibModal",function(e){var t=this;return t.factory={validate:function(t,r,n,o){var n=n||function(){},o=o||function(){};e.open({animation:!0,keyboard:!0,backdrop:"static",templateUrl:$TMPL+"validateByPassword.html",controller:"ModalValidateByPasswordCtrl",size:"sm",resolve:{modalHeader:function(){return t||"sessionExpired"},modalCancel:function(){return r||"cancel"}}}).result.then(function(){n()},function(){o()})},response:function(t,r,n){var n=n||function(){},t=t||"success",r=r||"operationSuccess";e.open({animation:!0,keyboard:!0,backdrop:"static",templateUrl:$TMPL+"operationResponse.html",controller:"ModalOperationResponseCtrl",size:"sm",resolve:{modalHeader:function(){return r},modalStatus:function(){return t}}}).result.then(function(){n()},function(){n()})}},t.factory}]);