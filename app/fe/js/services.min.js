"use strict";var wmoServices=angular.module("wmoServices",["ngResource"]);wmoServices.factory("Account",["$window",function(a){return{loggedOut:function(){return 0===(a.sessionStorage.getItem("sessID")||"").length},loggedIn:function(){return(a.sessionStorage.getItem("sessID")||"").length>0}}}]),wmoServices.factory("Calendar",[function(){var a=this;return a.dayMilliSeconds=864e5,a.factory={utc:function(a){var b,c=a||new Date,d=(new Date).getTimezoneOffset();return c instanceof Date||(c=new Date(c)),b=new Date(c.getFullYear(),c.getMonth(),c.getDate()),new Date(b.setMinutes(b.getMinutes()-d))},today:function(){return a.factory.utc()},local:function(a){var b=a,c=(new Date).getTimezoneOffset();return("number"==typeof a||a instanceof Number)&&(b=new Date(a)),new Date(b.setMinutes(b.getMinutes()+c))},addDays:function(b,c){var d=b||a.factory.today(),c=Number(c);return d instanceof Date||(d=new Date(d)),new Date(d.getFullYear(),d.getMonth(),d.getDate()+c)},addMonths:function(b,c){var d=b||a.factory.today(),c=Number(c);return d instanceof Date||(d=new Date(d)),new Date(d.getFullYear(),d.getMonth()+c,d.getDate())},addYears:function(b,c){var d=b||a.factory.today(),c=Number(c);return d instanceof Date||(d=new Date(d)),new Date(d.getFullYear()+c,d.getMonth(),d.getDate())},yyyyMMdd:function(b,c){var d=b||a.factory.today();d instanceof Date||(d=a.factory.local(d));var c=c||"",e=d.getFullYear(),f=Number(d.getMonth())+1,g=Number(d.getDate());return f<10&&(f="0"+f),g<10&&(g="0"+g),[e,f,g].join(c)},dayPeriod:function(b,c){var b=b||a.factory.today(),c=c||a.factory.today();return b instanceof Date||(b=new Date(b)),c instanceof Date||(c=new Date(c)),Math.round(Math.abs(c.getTime()-b.getTime())/a.dayMilliSeconds)},dayMilliSeconds:function(){return a.dayMilliSeconds}},a.factory}]),wmoServices.factory("CreateUser",["$resource",function(a){return a($REST,{},{get:{method:"POST",params:{api:"createUser"},headers:{Auth:"createuser"}}})}]),wmoServices.factory("Enroll",["$resource",function(a){return a($REST,{},{get:{method:"POST",params:{api:"enroll"},headers:{Auth:"enroll"}}})}]),wmoServices.factory("FilterSortTranslated",["$rootScope",function(a){return function(b,c){var c=(c||"").length>0&&c;if(c){var d="^"+c,e=new RegExp(d,"i");b=b.filter(function(b){return e.test(a.lang.tr(b))})}return b.sort(function(b,c){var d=a.lang.tr(b).toLowerCase().replace(/\s+/g,""),e=a.lang.tr(c).toLowerCase().replace(/\s+/g,"");return d>e?1:d<e?-1:0})}}]),wmoServices.factory("GetPlans",["$resource","$window",function(a,b){var c=this;return c.set=function(b){return a($REST,{},{getAll:{method:"POST",params:{api:"getPlans",operand:"all"},headers:{Auth:b}},getActive:{method:"POST",params:{api:"getPlans",operand:"active"},headers:{Auth:b}},getPermanent:{method:"POST",params:{api:"getPlans",operand:"permanent"},headers:{Auth:b}},getPending:{method:"POST",params:{api:"getPlans",operand:"pending"},headers:{Auth:b}},getCompleted:{method:"POST",params:{api:"getPlans",operand:"completed"},headers:{Auth:b}}})},{getAll:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.getAll(a,d)},getActive:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.getActive(a,d)},getPermanent:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.getPermanent(a,d)},getCompleted:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.getCompleted(a,d)},getPending:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.getPending(a,d)}}}]),wmoServices.factory("GetUser",["$resource","$window",function(a,b){var c=this;return c.set=function(b){return a($REST,{},{get:{method:"POST",params:{api:"operateUser",operand:"get"},headers:{Auth:b}},update:{method:"POST",params:{api:"operateUser",operand:"update"},headers:{Auth:b}}})},{get:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.get(a,d)},update:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.update(a,d)}}}]),wmoServices.factory("LangMngr",["$window","$rootScope",function(a,b){var c=this;return c.lang=a.sessionStorage.getItem("lang")||"eng",c.direction=a.sessionStorage.getItem("direction")||"ltr",c.locale=a.sessionStorage.getItem("locale")||"en",c.factory={getDirection:function(a){return $RTLS.indexOf(a)>-1?"rtl":"ltr"},getOppositeDirection:function(a){return $RTLS.indexOf(a)>-1?"ltr":"rtl"},getFloatDirection:function(a){return"rtl"===a?"right":"left"},getOppositeFloatDirection:function(a){return"rtl"===a?"left":"right"},showLTR:function(){return"ltr"===c.direction},showRTL:function(){return"rtl"===c.direction},tr:function(a,b){var b=b||c.lang;return a.isArray?a.map(function(a){return $DICT[a][b]}):$DICT[a][b]},getLocale:function(a){return $LANGS.filter(function(b){return b.value===a})[0].locale},setLang:function(d){c.lang=d,c.direction=c.factory.getDirection(d),c.locale=c.factory.getLocale(d),b.lang.lang=d,b.lang.direction=c.direction,b.lang.locale=c.locale,b.lang.floatDir=c.factory.getFloatDirection(c.direction),b.lang.oppositeFloatDir=c.factory.getOppositeFloatDirection(c.direction),a.sessionStorage.setItem("lang",d),a.sessionStorage.setItem("direction",c.direction),a.sessionStorage.setItem("locale",c.locale)},init:function(){return{lang:c.lang,direction:c.direction,locale:c.locale,floatDir:c.factory.getFloatDirection(c.direction),oppositeFloatDir:c.factory.getOppositeFloatDirection(c.direction),tr:c.factory.tr}}},c.factory}]),wmoServices.factory("Login",["$resource",function(a){return a($REST,{},{get:{method:"POST",params:{api:"login"},headers:{Auth:"login"}}})}]),wmoServices.factory("Logout",["$resource","$window",function(a,b){var c=this;return c.set=function(b){return a($REST,{},{get:{method:"POST",params:{api:"logout"},headers:{Auth:b}}})},{get:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.get(a,d)}}}]),wmoServices.factory("OperatePlan",["$resource","$window",function(a,b){var c=this;return c.set=function(b){return a($REST,{},{get:{method:"POST",params:{api:"operatePlan",operand:"get"},headers:{Auth:b}},update:{method:"POST",params:{api:"operatePlan",operand:"update"},headers:{Auth:b}},create:{method:"POST",params:{api:"operatePlan",operand:"create"},headers:{Auth:b}},remove:{method:"POST",params:{api:"operatePlan",operand:"remove"},headers:{Auth:b}}})},{get:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.get(a,d)},update:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.update(a,d)},create:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.create(a,d)},remove:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.remove(a,d)}}}]),wmoServices.factory("Registration",["$window",function(a){return{mailDenied:function(){return 0===(a.sessionStorage.getItem("email")||"").length},mailConfirmed:function(){return(a.sessionStorage.getItem("email")||"").length>0}}}]),wmoServices.factory("Validate",["$resource","$window",function(a,b){var c=this;return c.set=function(b){return a($REST,{},{get:{method:"POST",params:{api:"validate"},headers:{Auth:b}}})},{get:function(a,d){var e=b.sessionStorage.getItem("sessID"),f=c.set(e);f.get(a,d)}}}]),wmoServices.factory("ValidateByPassword",["$uibModal",function(a){var b=this;return b.factory={validate:function(b,c,d,e){var d=d||function(){},e=e||function(){},f=a.open({animation:!0,keyboard:!0,backdrop:"static",templateUrl:$TMPL+"validateByPassword.html",controller:"ModalValidateByPasswordCtrl",size:"sm",resolve:{modalHeader:function(){return b||"sessionExpired"},modalCancel:function(){return c||"cancel"}}});f.result.then(function(){d()},function(){e()})},response:function(b,c,d){var d=d||function(){},b=b||"success",c=c||"operationSuccess",e=a.open({animation:!0,keyboard:!0,backdrop:"static",templateUrl:$TMPL+"operationResponse.html",controller:"ModalOperationResponseCtrl",size:"sm",resolve:{modalHeader:function(){return c},modalStatus:function(){return b}}});e.result.then(function(){d()},function(){d()})}},b.factory}]);